<!-- ðŸ”¹ Lá»ŠCH Sá»¬ KHÃM (HISTORY) -->
<div th:fragment="history">
    <div th:if="${!#lists.isEmpty(history)}" class="d-flex flex-column gap-3">
        <div th:each="a : ${history}" class="card shadow-sm p-4 border-success-subtle">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h6 class="fw-bold text-success mb-1"
                        th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></h6>
                    <p class="text-secondary small mb-0">
                        Doctor: <strong th:text="${a.doctor.staff.fullName}"></strong>
                    </p>
                    <p class="text-muted small mb-0"> Checked at:
                        <span th:text="${#temporals.format(a.createdAt, 'HH:mm dd/MM')}"></span>
                    </p>
                </div>
                <span class="badge bg-success px-3 py-2">Completed</span>
            </div>

            <hr>
            <p class="text-muted mb-2"> Notes: <span th:text="${a.notes != null ? a.notes : 'â€”'}"></span></p>
            <div class="d-flex gap-2 flex-wrap mt-2">
                <a th:href="@{/patient/appointment/detail/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i> View Detail</a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(history)}" class="text-center text-muted mt-5">
        <i class="bi bi-calendar-check fs-1 text-secondary"></i>
        <p>No past appointments found.</p>
    </div>
</div>

<!-- ðŸ”¹ Lá»ŠCH Háº¸N ÄÃƒ Gá»¬I (SUBMITTED / PENDING) -->
<div th:fragment="submitted">
    <div th:if="${!#lists.isEmpty(submitted)}" class="d-flex flex-column gap-3">
        <div th:each="a : ${submitted}" class="card shadow-sm p-4 border-warning-subtle">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h6 class="fw-bold text-warning mb-1"
                        th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></h6>
                    <p class="small text-secondary mb-0">
                        <strong th:text="${a.doctor != null ? a.doctor.staff.fullName : 'No doctor assigned'}"></strong>
                    </p>
                </div>

                <span th:switch="${a.statusValue}">
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).PENDING.value}"
                          class="badge bg-warning text-dark">Pending</span>
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).CONFIRMED.value}"
                          class="badge bg-success">Confirmed</span>
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).CANCELLED.value}"
                          class="badge bg-danger">Cancelled</span>
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).EXAMINED.value}"
                          class="badge bg-primary">Re-Examined</span>
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).NO_SHOW.value}"
                          class="badge bg-dark">No Show</span>
                    <span th:case="${T(com.group4.clinicmanagement.enums.AppointmentStatus).CHECKED_IN.value}"
                          class="badge bg-info text-dark">Checked-In</span>
                    <span th:case="*" class="badge bg-secondary">Unknown</span>
                </span>
            </div>
            <hr>
            <p class="text-muted mb-2">Reason: <span th:text="${a.notes}"></span></p>
            <div class="d-flex gap-2 flex-wrap">
                <!-- luÃ´n hiá»ƒn thá»‹ View -->
                <a th:href="@{/patient/appointment/detail/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i> View</a>

                <!-- Náº¿u KHÃ”NG pháº£i tráº¡ng thÃ¡i CONFIRMED thÃ¬ hiá»ƒn thá»‹ Edit vÃ  Cancel -->
                <a th:if="${a.statusValue != T(com.group4.clinicmanagement.enums.AppointmentStatus).CONFIRMED.value}"
                   th:href="@{/patient/appointment/edit/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-warning"><i class="bi bi-pencil"></i> Edit</a>

                <a th:if="${a.statusValue != T(com.group4.clinicmanagement.enums.AppointmentStatus).CONFIRMED.value}"
                   th:href="@{/patient/appointment/cancel/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-danger"><i class="bi bi-x-circle"></i> Cancel</a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(submitted)}" class="text-center text-muted mt-5">
        <i class="bi bi-hourglass-split fs-1 text-secondary"></i>
        <p>No submitted appointments.</p>
    </div>
</div>

<!-- ðŸ”¹ Lá»ŠCH ÄÃƒ Há»¦Y (CANCELLED) -->
<div th:fragment="cancelled">
    <div th:if="${!#lists.isEmpty(cancelled)}" class="d-flex flex-column gap-3">
        <div th:each="a : ${cancelled}" class="card shadow-sm p-4 border-danger-subtle">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <h6 class="fw-bold text-danger mb-0"
                    th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></h6>
                <span class="badge bg-danger px-3 py-2">Cancelled</span>
            </div>
            <hr>
            <p class="text-muted mb-2">Reason:
                <span th:text="${a.cancelReason != null ? a.cancelReason : 'No reason provided'}"></span>
            </p>
            <div class="d-flex gap-2 flex-wrap">
                <a th:href="@{/patient/appointment/detail/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i> View Detail</a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(cancelled)}" class="text-center text-muted mt-5">
        <i class="bi bi-x-circle fs-1 text-secondary"></i>
        <p>No cancelled appointments.</p>
    </div>
</div>

<!-- ðŸ”¹ Lá»ŠCH ÄANG KHÃM (CURRENT / CHECKED-IN) -->
<div th:fragment="current">
    <div th:if="${!#lists.isEmpty(current)}" class="d-flex flex-column gap-3">
        <div th:each="a : ${current}" class="card shadow-sm p-4 border-info-subtle position-relative">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h6 class="fw-bold text-info mb-1"
                        th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></h6>
                    <p class="small text-secondary mb-0">
                        <strong th:text="${a.doctor.staff.fullName}"></strong>
                    </p>
                </div>
                <span class="badge bg-info text-dark px-3 py-2">Checked-in</span>
            </div>

            <hr>
            <p class="fw-bold text-primary mb-0">
                Queue number: <span th:text="${a.queueNumber}"></span>
            </p>
            <p class="text-muted small mb-1">
                Created at: <span th:text="${#temporals.format(a.createdAt, 'HH:mm dd/MM')}"></span>
            </p>

            <div class="d-flex gap-2 flex-wrap mt-2">
                <a th:href="@{/patient/appointment/detail/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i> Detail</a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(current)}" class="text-center text-muted mt-5">
        <i class="bi bi-person-standing fs-1 text-secondary"></i>
        <p>No active check-ins.</p>
    </div>
</div>

<!-- ðŸ”¹ Lá»ŠCH TÃI LHASM (EXAMINED) -->
<div th:fragment="examined">
    <div th:if="${!#lists.isEmpty(examined)}" class="d-flex flex-column gap-3">
        <div th:each="a : ${examined}" class="card shadow-sm p-4 border-warning-subtle">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h6 class="fw-bold text-warning mb-1"
                        th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></h6>
                    <p class="small text-secondary mb-0">
                        <strong th:text="${a.doctor != null ? a.doctor.user.fullName : 'No doctor assigned'}"></strong>
                    </p>
                </div>
                <span class="badge bg-warning text-dark px-3 py-2">Pending</span>
            </div>
            <hr>
            <p class="text-muted mb-2">Reason: <span th:text="${a.notes}"></span></p>
            <div class="d-flex gap-2 flex-wrap">
                <a th:href="@{/patient/appointment/detail/{id}(id=${a.appointmentId})}"
                   class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i> View</a>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(examined)}" class="text-center text-muted mt-5">
        <i class="bi bi-hourglass-split fs-1 text-secondary"></i>
        <p>No submitted appointments.</p>
    </div>
</div>