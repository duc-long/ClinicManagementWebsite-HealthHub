<!-- Dashboard -->
<div th:fragment="overview" class="section active" id="section-dashboard">
    <div class="row g-3">
        <div class="col-md-4">
            <div class="card-soft">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <div class="text-muted small">Today Appointments</div>
                        <div class="h4 fw-bold" th:text="${todayCount}">8</div>
                    </div>
                    <i class="fa-solid fa-calendar-day fa-xl"></i>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card-soft">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <div class="text-muted small">Waiting</div>
                        <div class="h4 fw-bold" th:text="${waitingCount}">3</div>
                    </div>
                    <i class="fa-solid fa-hourglass-half fa-xl"></i>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card-soft">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <div class="text-muted small">Messages</div>
                        <div class="h4 fw-bold" th:text="${unreadMsg}">5</div>
                    </div>
                    <i class="fa-solid fa-envelope-open-text fa-xl"></i>
                </div>
            </div>
        </div>
    </div>
    <hr/>
    <h6 class="fw-bold mb-3">Quick Actions</h6>
    <div class="d-flex flex-wrap gap-2">
        <a href="#" class="btn btn-primary" data-section="appointments"><i class="fa-solid fa-calendar-plus me-1"></i>
            View Appointments</a>
        <a href="#" class="btn btn-outline-secondary" data-section="patients"><i class="fa-solid fa-user-plus me-1"></i>
            Patients</a>
        <a href="#" class="btn btn-outline-secondary" data-section="prescriptions"><i
                class="fa-solid fa-file-prescription me-1"></i> Prescriptions</a>
    </div>
</div>

<!-- Appointment -->
<div th:fragment="appointments">
    <!-- Header -->
    <div class="d-flex align-items-center justify-content-between mb-3">
        <h5 class="m-0 fw-bold">
            <i class="fa-solid fa-calendar-check me-2"></i>Appointments
        </h5>
        <div class="d-flex gap-2">
            <input class="form-control" placeholder="Search patient / reason..." style="max-width:260px"/>
            <button class="btn btn-primary">
                <i class="fa-solid fa-magnifying-glass me-1"></i> Search
            </button>
        </div>
    </div>

    <!-- Content -->
    <div class="table-responsive">
        <!-- ðŸŸ¥ Khi KHÃ”NG cÃ³ dá»¯ liá»‡u -->
        <div th:if="${appointments == null or #lists.isEmpty(appointments)}"
             class="alert alert-info text-center mt-3" role="alert">
            <i class="fa-solid fa-circle-info me-2"></i>
            No appointment data available.
        </div>

        <!-- ðŸŸ© Khi CÃ“ dá»¯ liá»‡u -->
        <table th:if="${appointments != null and !#lists.isEmpty(appointments)}"
               class="table align-middle">
            <thead class="table-light">
            <tr>
                <th>#</th>
                <th>Patient</th>
                <th>Time</th>
                <th>Reason</th>
                <th class="text-end">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="a, i : ${appointments}">
                <td th:text="${i.index + 1}"></td>
                <td th:text="${a.patientName}">Tran Van A</td>
                <td>
                    <span th:text="${#temporals.format(a.appointmentDate, 'dd/MM/yyyy')}"></span>
                </td>
                <td th:text="${a.notes}">Chest pain</td>
                <td class="text-end">
                    <a href="#"
                       th:onclick="'loadDetail(\'appointment\', ' + ${a.appointmentId} + '); return false;'"
                       class="btn btn-sm btn-outline-warning">
                        <i class="fa-solid fa-folder-open me-1"></i> Open
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- appointment-detail -->
<div th:fragment="appointment-detail">
    <style>
        .card-soft {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            padding: 24px;
        }

        .info-label {
            font-weight: 600;
            color: #4f8cff;
            width: 160px;
        }

        .info-value {
            font-weight: 500;
            color: #333;
        }

        .btn-hm-primary {
            background-color: #4f8cff;
            border-color: #4f8cff;
            color: #fff;
            transition: 0.2s;
        }

        .btn-hm-primary:hover {
            background-color: #3f78e0;
            border-color: #3f78e0;
        }

        .btn-hm-secondary {
            border-color: #4f8cff;
            color: #4f8cff;
        }

        .btn-hm-secondary:hover {
            background-color: #4f8cff;
            color: #fff;
        }

        .section-title {
            color: #0b1a3a;
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }
    </style>

    <div>
        <div class="d-flex align-items-center justify-content-between mb-4">
            <h5 class="section-title mb-0">
                <i class="fa-solid fa-file-medical me-2"></i> Appointment Details
            </h5>
            <span th:text="${#temporals.format(appointment.appointmentDate, 'dd/MM/yyyy')}" class="text-muted small"></span>
        </div>

        <div class="card-soft">
            <div class="row mb-3">
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-center">
                        <span class="info-label"><i class="fa-solid fa-user me-2"></i>Patient:</span>
                        <span class="info-value" th:text="${appointment.patientName}">Tran Van A</span>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-center">
                        <span class="info-label"><i class="fa-solid fa-user-doctor me-2"></i>Doctor:</span>
                        <span class="info-value" th:text="${appointment.doctorName}">Dr. Nguyen Quoc Kiet</span>
                    </div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-center">
                        <span class="info-label"><i class="fa-solid fa-calendar-days me-2"></i>Date:</span>
                        <span class="info-value" th:text="${#temporals.format(appointment.appointmentDate, 'dd/MM/yyyy')}">23/10/2025</span>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-center">
                        <span class="info-label"><i class="fa-solid fa-clock me-2"></i>Created At:</span>
                        <span class="info-value" th:text="${#temporals.format(appointment.createdAt, 'HH:mm dd/MM/yyyy')}">10:30 22/10/2025</span>
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <div class="d-flex align-items-start">
                    <span class="info-label"><i class="fa-solid fa-comment-medical me-2"></i>Reason:</span>
                    <span class="info-value" th:text="${appointment.notes}">Chest pain and dizziness</span>
                </div>
            </div>

            <div class="mt-4 d-flex justify-content-end gap-2">
                <!-- ðŸ”™ Back to Appointments -->
                <button type="button"
                        class="btn btn-hm-secondary"
                        onclick="loadSection('appointments')">
                    <i class="fa-solid fa-arrow-left me-1"></i> Back to Appointments
                </button>

                <!-- ðŸ’Š Go to Diagnosis -->
                <button type="button"
                        class="btn btn-hm-primary"
                        onclick="loadSection('diagnosis')">
                    <i class="fa-solid fa-stethoscope me-1"></i> Go to Diagnosis & Prescription
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Patients -->
<div class="section" id="section-patients">
    <h5 class="fw-bold mb-3"><i class="fa-solid fa-user-group me-2"></i>Patients</h5>
    <div class="row g-3">
        <!-- th:each="p : ${patients}" -->
        <div class="col-md-6 col-xl-4">
            <div class="card h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center gap-3">
                        <img src="https://i.pravatar.cc/80?img=21" class="rounded-circle" width="56" height="56" alt="">
                        <div>
                            <div class="fw-semibold">Nguyen Thi B</div>
                            <div class="text-muted small">Female Â· 28</div>
                        </div>
                    </div>
                    <div class="mt-3 d-flex gap-2">
                        <a href="#" class="btn btn-sm btn-outline-primary">Records</a>
                        <a href="#" class="btn btn-sm btn-outline-secondary">Book</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- ... -->
    </div>
</div>

<!-- Schedule -->
<div class="section" id="section-schedule">
    <h5 class="fw-bold mb-3"><i class="fa-solid fa-clock me-2"></i>Weekly Schedule</h5>
    <div class="card-soft">
        <p class="m-0 text-muted">Embed calendar hoáº·c table ca trá»±c á»Ÿ Ä‘Ã¢yâ€¦</p>
    </div>
</div>

<!-- Prescriptions -->
<div class="section" id="section-prescriptions">
    <h5 class="fw-bold mb-3"><i class="fa-solid fa-prescription-bottle-medical me-2"></i>Prescriptions</h5>
    <div class="card-soft">
        <p class="m-0 text-muted">Danh sÃ¡ch toa thuá»‘c theo bá»‡nh nhÃ¢n/Ä‘Æ¡n gáº§n nháº¥t.</p>
    </div>
</div>

<!-- Messages -->
<div class="section" id="section-messages">
    <h5 class="fw-bold mb-3"><i class="fa-solid fa-message me-2"></i>Messages</h5>
    <div class="card-soft">
        <p class="m-0 text-muted">Inbox/Chat vá»›i bá»‡nh nhÃ¢n & nhÃ¢n sá»±.</p>
    </div>
</div>

<!-- Settings -->
<div th:fragment="profile">
    <style>
        .card-soft {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .text-hm-blue {
            color: #4f8cff;
        }

        .btn-outline-secondary:hover {
            background-color: #4f8cff;
            color: #fff;
            border-color: #4f8cff;
        }
    </style>

    <h5 class="fw-bold mb-3">
        <i class="fa-solid fa-user-doctor me-2"></i>Doctor Profile
    </h5>

    <div class="row g-4">
        <!-- Left column: Personal info -->
        <div class="col-lg-8">
            <div class="card-soft p-4">
                <h6 class="fw-semibold mb-3 text-hm-blue">Personal Information</h6>
                <div class="col-md-6">
                    <label class="form-label fw-semibold">Full Name</label>
                    <input type="text" class="form-control"
                           th:value="${doctor.fullName} ?: 'â€”'"
                           name="fullName" readonly>
                </div>

                <div class="col-md-6">
                    <label class="form-label fw-semibold">Email</label>
                    <input type="email" class="form-control"
                           th:value="${doctor.email} ?: 'â€”'"
                           name="email" readonly>
                </div>

                <div class="col-md-6">
                    <label class="form-label fw-semibold">Phone</label>
                    <input type="text" class="form-control"
                           th:value="${doctor.phone} ?: 'â€”'"
                           name="phone" readonly>
                </div>

                <div class="col-md-6">
                    <label class="form-label fw-semibold">Department</label>
                    <input type="text" class="form-control"
                           th:value="${department} ?: 'â€”'"
                           name="department" readonly>
                </div>

                <div class="col-md-6">
                    <label class="form-label fw-semibold">Gender</label>
                    <input type="text" class="form-control"
                           th:value="${doctor.gender} ?: 'â€”'"
                           name="gender" readonly>
                </div>

                <div class="col-12 text-end mt-3 d-flex justify-content-end gap-2">
                    <button type="button" class="btn btn-outline-secondary">
                        <i class="fa-solid fa-key me-1"></i> Change Password
                    </button>
                    <a th:href="@{/doctor/profile/edit/{id}(id=${doctor.doctorId})}" class="btn btn-primary">
                        <i class="fa-solid fa-pen-to-square me-1"></i> Edit Profile
                    </a>
                </div>
            </div>
        </div>

        <!-- Right column: Avatar -->
        <div class="col-lg-4">
            <div class="card-soft text-center p-4">
                <img th:src="${doctor.avatarFileName != null} ? '/images/avatars/doctor' + ${doctor.avatarFileName} : '/images/avatars/default-avatar.png'"
                     class="rounded-circle shadow mb-3 border border-3 border-light"
                     width="140" height="140" alt="Avatar">

                <h6 class="fw-bold mb-1" th:text="${doctor.fullName}">Dr. Nguyen Quoc Kiet</h6>
                <div class="text-muted small mb-3" th:text="${department}">Department</div>

                <form th:action="@{/doctor/avatarFilename}" method="post" enctype="multipart/form-data">
                    <input type="file" name="avatar" class="form-control mb-2" accept="image/*">
                    <button class="btn btn-outline-primary btn-sm w-100">
                        <i class="fa-solid fa-upload me-1"></i> Update Avatar
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
