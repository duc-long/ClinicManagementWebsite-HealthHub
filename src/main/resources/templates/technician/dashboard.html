<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Technician Dashboard - HealHub</title>
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <title>Title</title>
    <style>
        body {
            background-color: #f6f7fb;
        }

        .container-wide {
            max-width: 1200px;
        }

        .dashboard-summary {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .summary-card {
            flex: 1 1 200px;
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 2px 12px #0001;
            padding: 1.5rem 1.2rem;
            display: flex;
            align-items: center;
            gap: 1.2rem;
            min-width: 220px;
        }

        .summary-icon {
            font-size: 2.2rem;
            opacity: 0.85;
        }

        .summary-label {
            color: #6c757d;
            font-size: 1.02em;
        }

        .summary-value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .table thead th {
            background-color: #f8f9fa;
        }

        /* Sidebar styles */
        .sidebar {
            background: #fff;
            border-radius: .75rem;
            box-shadow: 0 2px 12px #0001;
            padding: 1rem;
            height: calc(100vh - 84px);
            position: sticky;
            top: 72px;
            overflow: auto;
        }

        .sidebar .nav-link {
            color: #495057;
            border-radius: .5rem;
            padding: .5rem .75rem;
        }

        .sidebar .nav-link.active, .sidebar .nav-link:hover {
            background: #e9f2ff;
            color: #0d6efd;
        }

        @media (max-width: 991.98px) {
            .sidebar {
                height: auto;
                position: relative;
                top: auto;
            }
        }
    </style>
</head>
<body>
<nav th:replace="~{fragment/technician/techinician-fragment :: navBar}"></nav>

<main class="container container-wide py-3 py-lg-4">
    <div class="row g-3">
        <!-- Sidebar for large screens -->
        <aside th:replace="~{/fragment/technician/techinician-fragment :: sidebar}"></aside>
        <!-- Main content -->
        <section class="col-12 col-lg-9">
            <h1 class="h3 mb-4"><i class="fa-solid fa-house-medical me-2 text-primary"></i>Technician Dashboard</h1>
            <div class="dashboard-summary">
                <div class="summary-card">
                    <span class="summary-icon text-primary"><i class="fa-solid fa-list-check"></i></span>
                    <div>
                        <div class="summary-label">Pending Requests</div>
                        <div class="summary-value" th:text="${#lists.size(labRequestDTOS)}"></div>
                    </div>
                </div>
                <div class="summary-card">
                    <span class="summary-icon text-info"><i class="fa-solid fa-vials"></i></span>
                    <div>
                        <div class="summary-label">Lab Tests Running</div>
                        <div class="summary-value" th:text="${#lists.size(labResultDTOS)}"></div>
                    </div>
                </div>
            </div>
            <div class="row g-3">
                <div class="col-12 col-xl-6">
                    <div class="card shadow-sm border-0">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <span class="fw-semibold"><i class="fa-solid fa-list-check me-1 text-primary"></i>Recent Requests</span>
                            <a class="btn btn-sm btn-outline-primary" th:href="@{/technician/request-list}">View
                                List</a>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Patient</th>
                                        <th>Test</th>
                                        <th>Status</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="request : ${labRequestDTOS}">
                                        <td>REQ-<span th:text="${request.labRequestId}"></span></td>
                                        <td th:text="${request.patient.user.fullName}"></td>
                                        <td th:text="${request.labTestCatalog.name}"></td>
                                        <td>
                                            <span th:switch="${request.status.name()}">
                                                <span th:case="'REQUESTED'" class="badge bg-secondary">Requested</span>
                                                <span th:case="'PAID'" class="badge bg-yellow">Paid</span>
                                                <span th:case="'COMPLETED'" class="badge bg-success">Completed</span>
                                                <span th:case="'CANCELLED'" class="badge bg-danger">Cancelled</span>
                                                <span th:case="'RUNNING'" class="badge bg-primary">Running</span>
                                            </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-xl-6">
                    <div class="card shadow-sm border-0">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <span class="fw-semibold"><i
                                    class="fa-solid fa-vial me-1 text-info"></i>Recent Lab Tests</span>
                            <a class="btn btn-sm btn-outline-primary" th:href="@{/technician/result-list}">View List</a>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                    <tr>
                                        <th>Resul ID</th>
                                        <th>Test</th>
                                        <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="result : ${labResultDTOS}">
                                        <td>RES-<span th:text="${result.resultId}"></span></td>
                                        <td th:text="${result.testName}"></td>
                                        <td>
                                            <span th:switch="${result.labRequestStatus}">
                                                <span th:case="'REQUESTED'" class="badge bg-secondary">Requested</span>
                                                <span th:case="'PAID'" class="badge bg-yellow">Paid</span>
                                                <span th:case="'COMPLETED'" class="badge bg-success">Completed</span>
                                                <span th:case="'CANCELLED'" class="badge bg-danger">Cancelled</span>
                                                <span th:case="'RUNNING'" class="badge bg-primary">Running</span>
                                            </span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<script th:src="@{/assets/js/bootstrap.bundle.min.js}"></script>
</body>
</html>